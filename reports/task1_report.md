## Отчет к заданию №1

Весь процесс состоит из нескольких этапов:
-Обработка данных
-Создание новых признаков
-Подбор гиперпараметров модели
-Итог

#### 1. Обработка данных
В данном процессе я использовал следующие техники:
- очистка данных от странных пробелов или символов, также знаков препинания и т.д.
- удаление стоп слов
- лемматизация

Код для обработки данных находится в файле
```
app/lib/data/preprocessing.py
app/lib/data/preprocessing.sh
```
Чтобы запустить предобработку данных, достаточно запустить файл preprocessing.sh и передать ему в качестве аргументов исполняемый файл и  размер батча для обработки(chunksize):
```
sh preprocessing.sh preprocessing.py 150000
```

#### 2. Создание новых признаков

Внимательно и детально рассмотрев данные, особенно колонку description, я заметил, что неплохо было бы создать признакие которые являются индикаторами наличия в описании упоминаний о почте, телефоне, мобильном операторе, ссылке на сайт и т.д.. Также я добавил такие признаки, как длина описания, длина заголовка количество цифр в заголовке, количество цифр в описании и т.д.
Полный список новых признаков приведен ниже

```


description_len - длина описания объявления
title_len - длина заголовка объявления
title_count_numbers - количество цифр в заголовке
description_count_numbers - количество цифр в описании
phone_normal - наличие номера телефона  в формате: "8XXXXXXXXXX", "+7XXXXXXXXXX" или " XXXXXXXXXX" (с пробелом в начале). Например - 89123456789
phone_strange - показывает наличие номера телефона которые содержат пробелы или другие нецифровые символы перед кодом страны (8 или +7) и после последней цифры номера телефона. Это может быть полезно для обнаружения номеров телефонов, записанных в нетипичной форме например - +7 (123) 456-78-90
has_site - есть ли сайте в тексте
has_email - указана ли электронная почта
home_phone - указан ли домашний телефон
phone_operators - присутствует ли название мобильного оператора в тексте
messenger - присутствует ли упоминание о соц. сети в тексте
filtered_text - очищенный текст не содержащий ничего кроме цифр, латинских букв и некоторых символов
filtered_numbers - очещенный текст не содержащий ничего кроме цифр и некоторых символов
```

#### 3. Подбор гиперпараметров модели
В качестве модели я решил использовать catboost, так как у него есть встроенный обработчик текстовых данных. Был вариант попробовать fasttext + lighgbm, но времени у меня было не так много :(

Для подбора гиперпараметров модели я использовал framework Optuna, а также hydra для более удобного управления этими самыми экспериментами через конфигурационные файлы.
Я провел несколько экспериментов, каждый из которых имеет свой конфигурационный файл с описанием в папке:
```
app/lib/model/config/experiments
```
Структура config файла:

```
id - номер эксперимента
best_params_path - путь до файла в который нужно сохранять лучшие гиперпараметры
cat_features - список категориальных признаков
target - целевой признак
drop_cols - список признаков, которые нужно удалить
text_features - список текстовых признаков
number_of_trials - количество итераций для подбора гиперпараметров
output_results_path - путь до папки с результатами
model_path - путь до места сохранения лучшей модельки
```
Для запуска экспериментов нужно задать конфигурационный файл и создать папку для сохранения результатов в директорию:
```
app/reports/exp_results/exp_{n} - где n - номер эксперимента
```
Далее нужно запустить файл run_exp.py при этом указав нужный эксперимент:

```
python run_exp.py experiments=exp_id_{n} - где n номер эксперимента
```


#### 3. Итог

К сожалению в моем распоряжении не было доступных GPU, и кол-во проведенных экспериментов не столь велико, одна baseline все же удалось побить.
Один из лучших результатов показала модель обученная в ходе третьего эксперимента, однако согласно метрики усредненного ROC-AUC по категориям это не лучшая модель. Более лучшее качество именно по этому показателю показала модель обученная в первом эксперименте. Но здесь я также смотрел и на другие метрики качества: Accuracy и F1. По остальным двум метрикам модель показала более лучший результат как в среднем по каждой отдельной категории, так и в общем.
